# 孫っち - タスクリスト

> 最終更新: 2024年12月

## Phase 0: PoC（技術検証）

### 0-1. 開発環境セットアップ
- [ ] リポジトリにpocディレクトリを作成
- [ ] Node.js + TypeScript環境の初期化
- [ ] 必要なAPIキーの取得
  - [ ] OpenAI API（Whisper用）
  - [ ] Anthropic API（Claude用）
  - [ ] ElevenLabs API（TTS用）※または VOICEVOX のローカルセットアップ
- [ ] 環境変数の設定（.env）

### 0-2. PoC-1: 音声入出力の基本動作
- [ ] ブラウザでマイク録音するHTMLページ作成
- [ ] MediaRecorder APIで音声をBlob化
- [ ] Whisper APIへ音声を送信
- [ ] 認識結果をテキスト表示
- [ ] 認識精度の確認（複数パターンでテスト）
- [ ] ElevenLabs/VOICEVOXでテキストを音声化
- [ ] 音声ファイルをブラウザで再生
- [ ] **検証結果を記録**

### 0-3. PoC-2: LLM会話の成立
- [ ] Claude APIへの接続確認
- [ ] 「孫っち」ペルソナのシステムプロンプト作成
- [ ] 基本的な会話のテスト
- [ ] ストリーミングレスポンスの実装
- [ ] 日本語での自然な応答確認
- [ ] **検証結果を記録**

### 0-4. PoC-3: 長期記憶の実現可能性
- [ ] Supabaseプロジェクト作成
- [ ] pgvector拡張の有効化
- [ ] OpenAI Embeddingsでテキストをベクトル化
- [ ] ベクトルをSupabaseに保存
- [ ] 類似検索の実行テスト
- [ ] 会話履歴の保存・検索テスト
- [ ] **検証結果を記録**

### 0-5. PoC-4: エンドツーエンド統合
- [ ] 音声入力→テキスト化→LLM→音声出力の一連のフロー実装
- [ ] 応答時間の計測
- [ ] ボトルネックの特定
- [ ] **Go/No-Go判断の実施**

---

## Phase 1: MVP基盤構築

### 1-1. プロジェクト構成
- [ ] monorepo構成の決定（frontend/backend分離 or 統合）
- [ ] frontendディレクトリ作成
  - [ ] Vite + Vue 3 + TypeScript初期化
  - [ ] TailwindCSS導入
  - [ ] Pinia導入
  - [ ] ESLint + Prettier設定
- [ ] backendディレクトリ作成
  - [ ] Fastify + TypeScript初期化
  - [ ] Zod導入
  - [ ] ESLint + Prettier設定
- [ ] 共通の型定義ディレクトリ作成

### 1-2. バックエンドAPI基盤
- [ ] Fastifyサーバーの基本設定
- [ ] CORS設定
- [ ] エラーハンドリング
- [ ] ヘルスチェックエンドポイント
- [ ] 環境変数管理

### 1-3. フロントエンド基盤
- [ ] 基本レイアウトコンポーネント
- [ ] ルーティング設定（Vue Router）
- [ ] API通信ユーティリティ（fetch wrapper）
- [ ] 基本的なスタイル設定（色、フォントサイズ）

---

## Phase 1: MVP機能実装

### 1-4. 音声会話機能
- [ ] **フロントエンド**
  - [ ] 音声録音コンポーネント
  - [ ] 「話す」ボタン（大きく、わかりやすく）
  - [ ] 録音中インジケーター
  - [ ] 音声再生コンポーネント
  - [ ] 会話履歴表示コンポーネント
  - [ ] ストリーミングテキスト表示
- [ ] **バックエンド**
  - [ ] POST /api/voice/transcribe（音声→テキスト）
  - [ ] POST /api/chat（テキスト→LLM応答）
  - [ ] POST /api/voice/synthesize（テキスト→音声）
  - [ ] ストリーミングレスポンス対応

### 1-5. 買い物リスト機能
- [ ] **データベース**
  - [ ] shopping_itemsテーブル設計
  - [ ] Drizzle ORMスキーマ作成
- [ ] **バックエンド**
  - [ ] GET /api/shopping-list
  - [ ] POST /api/shopping-list
  - [ ] DELETE /api/shopping-list/:id
- [ ] **LLM統合**
  - [ ] 「買い物リストに〇〇追加」の意図認識
  - [ ] 「買い物リスト教えて」の意図認識
  - [ ] 「〇〇消して」の意図認識
  - [ ] Function calling または プロンプト設計

### 1-6. リマインダー機能
- [ ] **データベース**
  - [ ] remindersテーブル設計
  - [ ] Drizzle ORMスキーマ作成
- [ ] **バックエンド**
  - [ ] GET /api/reminders
  - [ ] POST /api/reminders
  - [ ] DELETE /api/reminders/:id
- [ ] **フロントエンド**
  - [ ] ブラウザ通知の許可リクエスト
  - [ ] 通知表示機能
- [ ] **LLM統合**
  - [ ] 「〇〇時に△△を思い出させて」の意図認識
  - [ ] 日時パース処理

### 1-7. 情報提供機能
- [ ] **天気API連携**
  - [ ] OpenWeatherMap or 天気API選定
  - [ ] 地域設定機能
  - [ ] GET /api/weather
- [ ] **日時情報**
  - [ ] 現在日時の応答
  - [ ] 「〇〇まであと何日」の計算
- [ ] **LLM統合**
  - [ ] 「今日の天気は？」の意図認識
  - [ ] 「今日は何日？」の意図認識

### 1-8. 長期記憶統合
- [ ] **会話履歴の保存**
  - [ ] conversationsテーブル設計
  - [ ] ベクトル埋め込みの保存
- [ ] **コンテキスト取得**
  - [ ] 関連する過去の会話を検索
  - [ ] LLMプロンプトへの組み込み

### 1-9. 設定画面
- [ ] ユーザー名設定
- [ ] 地域設定（天気用）
- [ ] 音量設定
- [ ] 設定のローカルストレージ保存

---

## Phase 1: 仕上げ

### 1-10. UI/UX改善
- [ ] レスポンシブ対応（タブレット最適化）
- [ ] 文字サイズ確認（18px以上）
- [ ] ボタンサイズ確認（48px以上）
- [ ] コントラスト比確認
- [ ] ローディング状態の表示
- [ ] エラー状態の表示

### 1-11. テスト
- [ ] 主要機能の手動テスト
- [ ] 音声認識精度の確認
- [ ] 応答時間の計測
- [ ] エッジケースの確認

### 1-12. デプロイ
- [ ] Supabaseプロジェクト本番設定
- [ ] フロントエンドをVercelにデプロイ
- [ ] バックエンドをRailway/Renderにデプロイ
- [ ] 環境変数の設定
- [ ] 動作確認

---

## 優先度について

**最優先（PoC）**
- 0-1 → 0-2 → 0-3 → 0-4 → 0-5 の順で実施
- PoC完了後にGo/No-Go判断

**MVP実装順序**
1. 音声会話機能（1-4）← コア機能
2. 買い物リスト（1-5）← 最もシンプルなタスク機能
3. リマインダー（1-6）
4. 情報提供（1-7）
5. 長期記憶（1-8）
6. 設定・仕上げ（1-9〜1-12）

---

*関連ドキュメント: [ロードマップ](./02_ROADMAP.md) | [MVP仕様](./03_MVP_SPEC.md)*
